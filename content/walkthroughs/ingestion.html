<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Ingesting data into the Information Store </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Ingesting data into the Information Store ">
    <meta name="generator" content="docfx 2.56.2.0">
    
    <link rel="shortcut icon" href="../../images/favicon.png">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                i2 Analyze Containers
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
          
          <div class="subnav navbar navbar-default">
            <div class="container hide-when-search" id="breadcrumb">
              <ul class="breadcrumb">
                <li></li>
              </ul>
            </div>
          </div>
            <article class="content wrap" id="_content" data-uid="">
<h1 id="ingesting-data-into-the-information-store">Ingesting data into the Information Store</h1>

<p>The <code>examples/pre-prod/walkthroughs/change-management/ingestDataWalkthrough.sh</code> script is a worked example that demonstrates how to script the process of ingesting data into the Information Store.</p>
<blockquote><p>Note: Before you complete this walkthrough, reset your environment to the base configuration. For more information, see <a href="reset_walkthroughs.html">Resetting your environment</a>.</p>
</blockquote>
<p>The example provides a scripted mechanism to ingest data by using ETL toolkit. The script ingests data with and without correlation identifiers using both <code>STANDARD</code> and <code>BULK</code> import modes.<br>For more information about ingestion, see:</p>
<ul>
<li><a href="https://docs.i2group.com/analyze/4.4.0/data_ingestion.html">Information Store data ingestion</a></li>
<li><a href="https://docs.i2group.com/analyze/4.4.0/c_correlation_intro.html">Information Store data correlation</a></li>
</ul>
<p>To script the ingestion process, the following information is stored within the script:  </p>
<ul>
<li>The mapping of item type identifiers to staging tables</li>
<li>The mapping of staging tables to CSV files and format files.</li>
<li>A list of import mapping identifiers from the mapping file.</li>
</ul>
<p>The script uses the <code>runSqlServerCommandAsETL</code> client function to import the data into the staging tables, and <code>runEtlToolkitToolAsi2ETL</code> to run the ingestion commands.
Note the external ETL user is performing the import into the staging tables, but the i2 Internal ETL user is executing ETL tasks such as creating the ingestion source or performing the import from the staging tables.</p>
<p>The data and ingestion artifacts that are used in the example are in the <code>examples/data</code> directory of the minimal toolkit.</p>
<h2 id="creating-the-ingestion-sources">Creating the ingestion sources</h2>
<p>The <code>runEtlToolkitToolAsi2ETL</code> client function is used to run <code>addInformationStoreIngestionSource</code> ETL toolkit tool to create the ingestion sources.</p>
<ul>
<li><a href="../tools%20and%20functions/client_functions.html#runEtlToolkitToolAsi2ETL">runEtlToolkitToolAsi2ETL</a></li>
<li><a href="../tools%20and%20functions/etl_tools.html#add-information-store-ingestion-source">addInformationStoreIngestionSource</a></li>
<li>For more information about ingestion sources in the Information Store, see <a href="https://docs.i2group.com/analyze/4.4.0/define_ingestion_source.html">Defining an ingestion source</a></li>
</ul>
<p>For an example of how to use the tool, see the <code>Create the ingestion sources</code> section in the <code>ingestDataWalkthrough.sh</code></p>
<h2 id="creating-the-staging-tables">Creating the staging tables</h2>
<p>The <code>runEtlToolkitToolAsi2ETL</code> client function is used to run <code>createInformationStoreStagingTable</code> ETL toolkit tool to create the staging tables.</p>
<ul>
<li><a href="../tools%20and%20functions/client_functions.html#runEtlToolkitToolAsi2ETL">runEtlToolkitToolAsi2ETL</a></li>
<li><a href="../tools%20and%20functions/etl_tools.html#create-information-store-staging-table">createInformationStoreStagingTable</a></li>
<li>For more information about creating staging tables in the Information Store, see <a href="https://docs.i2group.com/analyze/4.4.0/create_staging_stables.html">Creating the staging tables</a></li>
</ul>
<p>To create all of the staging tables in the example, schema type identifiers are mapped to staging table names. For an example of how the mappings are used, see the <code>Create the staging tables</code> section in the <code>ingestDataWalkthrough.sh</code></p>
<blockquote><p>Note: Because there are multiple staging tables for the <code>LAC1</code> link type, a second loop is used to iterate through the staging table names of each schema type.</p>
</blockquote>
<h2 id="ingesting-data">Ingesting data</h2>
<p>The walkthrough demonstrates how to ingest both non-correlated and correlated data.
For each type of data the staging tables and populated, the data ingestion task is executed, then the staging tables are cleaned.</p>
<h3 id="ingesting-non-correlated-data">Ingesting non correlated data</h3>
<p>In this case, the SQL Server <code>BULK INSERT</code> command is used to insert the CSV data into the staging tables.</p>
<h3 id="ingesting-correlated-data">Ingesting correlated data</h3>
<p>See the <code>Ingesting correlated data</code> section of the walkthrough script.</p>
<h3 id="the-ingestion-procedure">The ingestion procedure</h3>
<p>The <code>runSqlServerCommandAsETL</code> client function is used to run the sql statement that inserts the data into the staging tables.</p>
<ul>
<li><a href="../tools%20and%20functions/client_functions.html#runSqlServerCommandAsETL">runSqlServerCommandAsETL</a></li>
<li><a href="https://docs.i2group.com/analyze/4.4.0/c_stage_data.html">Populating the staging tables</a></li>
</ul>
<p>The example uses CSV and format files to insert the data. The files have the same name (<code>person.csv</code> and <code>person.fmt</code>). The staging table names are mapped to the CSV and format files. There is one mapping for base data (<code>BASE_DATA_TABLE_TO_CSV_AND_FORMAT_FILE_NAME</code>) and one for correlation data (<code>CORRELATED_DATA_TABLE_AND_FORMAT_FILE_NAME</code>).
For an example of how the mappings are used, see the <code>Insert the base data into the staging tables</code> section in the <code>ingestDataWalkthrough.sh</code></p>
<p>The <code>runEtlToolkitToolAsi2ETL</code> client function is used to run <code>ingestInformationStoreRecords</code> ETL toolkit tool to ingest the data into the Information Store from the staging tables.</p>
<ul>
<li><a href="../tools%20and%20functions/client_functions.html#runEtlToolkitToolAsi2ETL">runEtlToolkitToolAsi2ETL</a></li>
<li><a href="../tools%20and%20functions/etl_tools.html#ingest-information-store-records">ingestInformationStoreRecords</a></li>
<li><a href="https://docs.i2group.com/analyze/4.4.0/ingestion_command.html">The ingestInformationStoreRecords toolkit task</a></li>
</ul>
<p>The <code>ingestInformationStoreRecords</code> tool is used with <code>BULK</code> and <code>STANDARD</code> import modes. Standard import mode is used to ingest the correlation data sets.
Bulk import mode is used to ingest the base data set.</p>
<p>The import mapping identifiers to use with the <code>ingestInformationStoreRecords</code> tool are defined in the <code>IMPORT_MAPPING_IDS</code> and <code>BULK_IMPORT_MAPPING_IDS</code> lists.</p>
<p>A loop is used to ingest data for each mapping identifier in the lists.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            &copy; N. Harris Computer Corporation (2022)
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
