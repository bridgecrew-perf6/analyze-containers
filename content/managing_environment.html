<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Managing the environment </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Managing the environment ">
    <meta name="generator" content="docfx 2.56.2.0">
    
    <link rel="shortcut icon" href="../images/favicon.png">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                i2 Analyze Containers
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
          
          <div class="subnav navbar navbar-default">
            <div class="container hide-when-search" id="breadcrumb">
              <ul class="breadcrumb">
                <li></li>
              </ul>
            </div>
          </div>
            <article class="content wrap" id="_content" data-uid="">
<h1 id="managing-the-environment">Managing the environment</h1>

<p>The <code>manageEnvironment.sh</code> script is used to manage the dev environment rather than specific configs. The actions that the script can complete include; backing up and restoring all configs, upgrading configs to a later version, and building connectors.</p>
<h2 id="i2-analyze-version">i2 Analyze version</h2>
<p>In a the config dev environment and a containerized deployment, the images that are used for the containers are built for a specific version on i2 Analyze. To identify the version of i2 Analyze that a particular image is built for, inspect the the image.</p>
<p>To inspect the images, use the Docker extension in VS Code.<br>The <code>liberty_configured_redhat</code> &amp; <code>solr_redhat</code> image includes the version number in the tag. For example: <code>config-development-4.4.0.0</code></p>
<p>Each config includes a version file that reports the i2 Analyze version for that config. This value does not include the fix pack version number.<br>For example, the version file contains: <code>SUPPORTED_I2ANALYZE_VERSION=4.4.0</code></p>
<h2 id="the-manageenvironmentsh-script">The <code>manageEnvironment.sh</code> script</h2>
<p>The <code>scripts/manageEnvironment.sh</code> script is used to manage to development environment rather than specific configs.</p>
<p>The following usage and help is provided for the <code>manageEnvironment.sh</code> script:</p>
<pre><code class="lang-bash">Usage:
  manageEnvironment.sh -t backup [-b &lt;backup_name&gt;] [-p &lt;path&gt;] [-i &lt;config_name&gt;] [-e &lt;config_name&gt;] [-y]
  manageEnvironment.sh -t copy -p &lt;path&gt; [-i &lt;config_name&gt;] [-e &lt;config_name&gt;] [-y]
  manageEnvironment.sh -t upgrade -p &lt;path&gt; [-y]
  manageEnvironment.sh -t update [-y]
  manageEnvironment.sh -t clean [-i &lt;config_name&gt;] [-e &lt;config_name&gt;] [-y]
  manageEnvironment.sh -t connectors [-i &lt;connector_name&gt;] [-e &lt;connector_name&gt;] [-y]
  manageEnvironment.sh -t extensions [-i &lt;extension_name&gt;] [-e &lt;extension_name&gt;] [-y]
  manageEnvironment.sh -h

Options:
  -t {backup}                                     Backup the database for a config.
  -t {copy}                                       Copy the dependencies for a config from the specified path, to the current analyze-containers project.
  -t {upgrade}                                    Upgrade all configurations from the specified path.
  -t {update}                                     Pulls the latest base images from Docker Hub and rebuilds the local images.
  -t {clean}                                      Clean the deployment for a config. Will permanently remove all containers and data.
  -t {connectors}                                 Build all connector images.
  -t {extensions}                                 Build all extensions.
  -i &lt;config_name|extension_name|connector_name&gt;  Name of the config, connector or extension to include for the task. To specify multiple values, add additional -i options.
  -e &lt;config_name|extension_name|connector_name&gt;  Name of the config, connector or extension to exclude for the task. To specify multiple values, add additional -e options.
  -b &lt;backup_name&gt;                                Name of the backup to create or restore. If not specified, the default backup is used.
  -p &lt;path&gt;                                       Path to the root of an analyze-containers project. Defaults to the current project path.
  -y                                              Answer &#39;yes&#39; to all prompts.
  -v                                              Verbose output.
  -h                                              Display the help.
</code></pre><h2 id="backup-and-restore">Backup and restore</h2>
<p>The <code>backup</code> and <code>restore</code> tasks allow you to back up and restore a number of configurations by using one command. To back up a single config, use the <code>deploy.sh</code> script that is described in <a href="manage_backup_restore.html">back up and restore</a>.</p>
<p>To back up all of the configs in your environment, run:</p>
<pre><code class="lang-bash">./manageEnvironment.sh -t backup -b backup-202206
</code></pre><p>This creates a backup named <code>backup-202206</code> for all configs in the environment.</p>
<h2 id="updating-the-docker-images">Updating the Docker images</h2>
<p>The <code>update</code> task pulls the latest images from Docker Hub and rebuilds the local images. Use this task to update the images in your environments. Images on Docker Hub are updated with security fixes and other updates. For more information, see <a href="manage_update_images.html">Update the Docker images</a>.</p>
<h2 id="upgrading">Upgrading</h2>
<p>The <code>upgrade</code> task allows you to upgrade the configs in your environment to a later version of Analyze containers or i2 Analyze.<br>For more information, see <a href="managing_upgrade_env.html">Upgrading</a>.</p>
<h2 id="copying-configurations">Copying configurations</h2>
<p>The <code>copy</code> task allows you to copy configs from one development environment to another.</p>
<ol>
<li><p>To mount the directory in the dev container, open the <code>devcontainer.json</code> file inside <code>.devcontainer</code> directory. In the <code>mounts</code> object, add the path to another analyze-containers directory as the source and target.<br>For example:</p>
<pre><code class="lang-json"> &quot;mounts&quot;: [
   ...
   &quot;source=/home/&lt;user-name&gt;/analyze-containers,target=/home/&lt;user-name&gt;/analyze-containers,type=bind,consistency=cached&quot;
 ]
</code></pre></li>
<li><p>Press <strong>F1</strong> (or <strong>Cmd+Shift+P</strong> in MacOS) and type <code>Remote-Containers: Rebuild Container</code> and select it.</p>
</li>
<li><p>Run the following command from the <code>scripts</code> directory:</p>
<pre><code class="lang-sh">./manageEnvironment.sh -p &lt;path&gt; -t copy
</code></pre><p> Where <code>&lt;path&gt;</code> is the absolute path to the root of another <code>analyze-containers</code> repository.</p>
<p> This script copies the following directories:</p>
<ul>
<li><code>backups</code></li>
<li><code>configs</code></li>
<li><code>connector-images</code></li>
<li><code>dev-environment-secrets</code></li>
<li><code>gateway-schemas</code></li>
<li><code>i2a-data</code></li>
<li><p><code>i2a-extensions</code></p>
<p>If you specify to include or exclude any configs by using the <code>-i</code> and <code>-e</code> options, only the directories that are referenced by the configs are copied.</p>
</li>
</ul>
</li>
</ol>
<h2 id="building-connectors">Building connectors</h2>
<p>The connectors that are referenced by a config are built and deployed when that config is deployed. You can optionally build all connectors or a subset of the connectors by using the <code>manageEnvironment.sh</code> script with the <code>connectors</code> task.</p>
<ul>
<li><p>To build all of the connector images, run:</p>
<pre><code class="lang-sh">./manageEnvironment.sh -t connectors
</code></pre></li>
<li><p>To build a subset of the connector images, you can use of the include (<code>-i</code>) and exclude (<code>-e</code>) options.<br>For example:</p>
<pre><code class="lang-sh">./manageEnvironment.sh -t connectors -i connector_name_1 -i connector_name_2
</code></pre><p>This command only builds images for <code>connector_name_1</code> and <code>connector_name_2</code>.</p>
<pre><code class="lang-sh">./manageEnvironment.sh -t connectors -e &lt;connector_name_1&gt; -e &lt;connector_name_2&gt;
</code></pre><p>This command builds the images for all connectors except <code>connector_name_1</code> and <code>connector_name_2</code>.</p>
</li>
</ul>
<h2 id="building-extensions">Building extensions</h2>
<p>The extensions that are referenced by a config are built and deployed when that config is deployed. You can optionally build all extensions or a subset of the extensions by using the <code>manageEnvironment.sh</code> script with the <code>extensions</code> task.</p>
<ul>
<li><p>To build all of the extensions, run:</p>
<pre><code class="lang-sh">./manageEnvironment.sh -t extensions
</code></pre></li>
<li><p>To build a subset of the extensions, you can use the include (<code>-i</code>) and exclude (<code>-e</code>) options.<br>For example:</p>
<pre><code class="lang-sh">./manageEnvironment.sh -t extensions -i extension_1 -i extension_2
</code></pre><p>This command only builds <code>extension_1</code> and <code>extension_2</code>.</p>
<pre><code class="lang-sh">./manageEnvironment.sh -t extensions -e &lt;extension_1&gt; -e &lt;extension_2&gt;
</code></pre><p>This command builds all of the extensions except <code>extension_1</code> and <code>extension_2</code>.</p>
</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            &copy; N. Harris Computer Corporation (2022)
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
