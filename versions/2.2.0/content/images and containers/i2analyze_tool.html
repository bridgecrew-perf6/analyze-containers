<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>i2 Analyze Tool </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="i2 Analyze Tool ">
    <meta name="generator" content="docfx 2.56.2.0">
    
    <link rel="shortcut icon" href="../../../../images/favicon.png">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                i2 Analyze Containers
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
          
          <div class="subnav navbar navbar-default">
            <div class="container hide-when-search" id="breadcrumb">
              <ul class="breadcrumb">
                <li></li>
              </ul>
            </div>
          </div>
            <article class="content wrap" id="_content" data-uid="">
<h1 id="i2-analyze-tool">i2 Analyze Tool</h1>

<p>An i2 Analyze Tool container is an ephemeral container that is used to run the i2 Analyze tools. For more information about the tools, see <a href="../tools%20and%20functions/i2analyze_tools.html">i2 Analyze tools</a>.</p>
<h2 id="building-the-i2-analyze-tool-image">Building the i2 Analyze Tool image</h2>
<p>The i2 Analyze Tool image is built from the Dockerfile in <code>images/i2a_tools</code>.</p>
<p>The image contains the <code>i2-tools</code> &amp; <code>scripts</code> folder from the toolkit.</p>
<h3 id="docker-build-command">Docker build command</h3>
<p>The following <code>docker build</code> command builds the i2 Analyze Tool image:</p>
<pre><code class="lang-bash">docker image build -t i2a_tools_redhat:4.3.5 images/i2a_tools \
  --build-arg USER_UID=&quot;$(id -u &quot;${USER}&quot;)&quot;
</code></pre><p>The <code>--build-arg</code> flag is used to provide your local user ID to the Docker image when it is built. The value of <code>$USER</code> comes from your shell.</p>
<p>The local user ID is required so that a user is created in the Docker container with the same user ID as the local user. The user is required to ensure that the local user can access any files that are generated on the container and mounted to the host via a bind mount.</p>
<p>For examples of the build commands, see <code>buildImages.sh</code> script.</p>
<h2 id="running-an-i2-analyze-tool-container">Running an i2 Analyze Tool container</h2>
<p>An i2 Analyze Tool container uses the i2 Analyze Tool image. In the <code>docker run</code> command, you can use <code>-e</code> to pass environment variables to the container. The environment variables are described in <a href="#environment-variables">environment variables</a></p>
<p>For more information about the command, see <a href="https://docs.docker.com/engine/reference/run/">docker run reference</a>.</p>
<h3 id="docker-run-command">Docker run command</h3>
<p>The following <code>docker run</code> command runs an i2 Analyze Tool container:</p>
<pre><code class="lang-bash">  docker run \
    --rm \
    --name &quot;i2atool&quot; \
    --network &quot;eia&quot; \
    --user &quot;$(id -u &quot;${USER}&quot;):$(id -u &quot;${USER}&quot;)&quot; \
    -v &quot;/examples/pre-prod/configuration:/opt/configuration&quot; \
    -v &quot;/examples/pre-prod/database-scripts/generated:/opt/databaseScripts/generated&quot; \
    -e LIC_AGREEMENT=&quot;ACCEPT&quot; \
    -e ZK_HOST=&quot;zk1.eia:2281,zk2.eia:2281,zk3.eia:2281&quot; \
    -e DB_DIALECT=&quot;sqlserver&quot; \
    -e DB_SERVER=&quot;sqlserver.eia&quot; \
    -e DB_PORT=1433 \
    -e DB_NAME=&quot;ISTORE&quot; \
    -e CONFIG_DIR=&quot;/opt/configuration&quot; \
    -e GENERATED_DIR=&quot;/opt/databaseScripts/generated&quot; \
    -e DB_USERNAME=&quot;dba&quot; \
    -e DB_PASSWORD=&quot;DBA_PASSWORD&quot; \
    -e DB_OS_TYPE=&quot;UNIX&quot; \
    -e DB_INSTALL_DIR=&quot;/opt/mssql-tools&quot; \
    -e DB_LOCATION_DIR=&quot;/var/opt/mssql/data&quot; \
    -e SOLR_ADMIN_DIGEST_USERNAME=&quot;solr&quot; \
    -e SOLR_ADMIN_DIGEST_PASSWORD=&quot;SOLR_ADMIN_DIGEST_PASSWORD&quot; \
    -e ZOO_DIGEST_USERNAME=&quot;solr&quot; \
    -e ZOO_DIGEST_PASSWORD=&quot;ZOO_DIGEST_PASSWORD&quot; \
    -e ZOO_DIGEST_READONLY_USERNAME=&quot;readonly-user&quot; \
    -e ZOO_DIGEST_READONLY_PASSWORD=&quot;ZOO_DIGEST_READONLY_PASSWORD&quot; \
    -e DB_SSL_CONNECTION=true \
    -e SOLR_ZOO_SSL_CONNECTION=true \
    -e SSL_PRIVATE_KEY=&quot;SSL_PRIVATE_KEY&quot; \
    -e SSL_CERTIFICATE=&quot;SSL_CERTIFICATE&quot; \
    -e SSL_CA_CERTIFICATE=&quot;SSL_CA_CERTIFICATE&quot; \
    &quot;i2a_tools_redhat:4.3.5&quot; &quot;$@&quot;
</code></pre><h3 id="bind-mounts">Bind mounts</h3>
<ul>
<li><p><strong>Configuration</strong>:<br>The i2 Analyze Tool container requires the i2 Analyze configuration. To access the configuration, the <code>configuration</code> directory must be mounted into the container. The <code>CONFIG_DIR</code> environment variable must specify the location where the configuration is mounted.</p>
</li>
<li><p><strong>Generated scripts directory</strong>:<br>Some of the i2 Analyze tools generate scripts to be run against the Information Store database, or run scripts that were generated by other i2 Analyze tools. For the i2 Analyze Tool container to interact with these scripts, the directory where they are generated must be mounted into the container.<br>In the example scripts, this is defaulted to <code>/database-scripts/generated</code>. The <code>GENERATED_DIR</code> environment variable must specify the location where the generated scripts are mounted.  </p>
</li>
</ul>
<p>This directory must be created with your local user before mounting it to the container, otherwise docker will create this directory as a root.</p>
<h3 id="environment-variables">Environment variables</h3>
<p>To configure the i2 Analyze Tool container, you provide environment variables to the Docker container in the <code>docker run</code> command.</p>
<p>The following table describes the supported environment variables that you can use:</p>
<table>
<thead>
<tr>
<th>Environment variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LIC_AGREEMENT</code></td>
<td>The license agreement for use the i2Analyze tools.</td>
</tr>
<tr>
<td><code>ZK_HOST</code></td>
<td>The connection string the ZooKeeper client to connect to.</td>
</tr>
<tr>
<td><code>DB_DIALECT</code></td>
<td>See <a href="../tools%20and%20functions/i2analyze_tools.html#connection-properties">i2a Tools Environment Variables</a>.</td>
</tr>
<tr>
<td><code>DB_SERVER</code></td>
<td>See <a href="../tools%20and%20functions/i2analyze_tools.html#connection-properties">i2a Tools Environment Variables</a>.</td>
</tr>
<tr>
<td><code>DB_PORT</code></td>
<td>See <a href="../tools%20and%20functions/i2analyze_tools.html#connection-properties">i2a Tools Environment Variables</a>.</td>
</tr>
<tr>
<td><code>DB_NAME</code></td>
<td>See <a href="../tools%20and%20functions/i2analyze_tools.html#connection-properties">i2a Tools Environment Variables</a>.</td>
</tr>
<tr>
<td><code>CONFIG_DIR</code></td>
<td>The root location of the configuration directory.</td>
</tr>
<tr>
<td><code>GENERATED_DIR</code></td>
<td>The root location where any generated scripts are created.</td>
</tr>
<tr>
<td><code>CLASSES_PATH</code></td>
<td>The location to the files required by the i2 Analyze tools. The files are built into the image.</td>
</tr>
<tr>
<td><code>DB_USERNAME</code></td>
<td>See <a href="../tools%20and%20functions/i2analyze_tools.html#connection-properties">i2a Tools Environment Variables</a>.</td>
</tr>
<tr>
<td><code>DB_PASSWORD</code></td>
<td>See <a href="../tools%20and%20functions/i2analyze_tools.html#connection-properties">i2a Tools Environment Variables</a>.</td>
</tr>
<tr>
<td><code>SOLR_ADMIN_DIGEST_USERNAME</code></td>
<td>The name of the administrator user for performing administration tasks.</td>
</tr>
<tr>
<td><code>SOLR_ADMIN_DIGEST_PASSWORD</code></td>
<td>The password for the administrator user.</td>
</tr>
<tr>
<td><code>ZOO_DIGEST_USERNAME</code></td>
<td>The ZooKeeper administrator user name. This environment variable maps to the <code>zkDigestUsername</code> system property.</td>
</tr>
<tr>
<td><code>ZOO_DIGEST_PASSWORD</code></td>
<td>The ZooKeeper administrator password. This environment variable maps to the <code>zkDigestPassword</code> system property.</td>
</tr>
<tr>
<td><code>ZOO_DIGEST_READONLY_USERNAME</code></td>
<td>The ZooKeeper read-only user name. This environment variable maps to the <code>zkDigestReadonlyUsername</code> system property.</td>
</tr>
<tr>
<td><code>ZOO_DIGEST_READONLY_PASSWORD</code></td>
<td>The ZooKeeper read-only password. This environment variable maps to the <code>zkDigestReadonlyPassword</code> system property.</td>
</tr>
</tbody>
</table>
<p>The following environment variables enable you to use SSL:</p>
<table>
<thead>
<tr>
<th>Environment variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SERVER_SSL</code></td>
<td>See <a href="../security%20and%20users/security.html#secure-environment-variables">Secure Environment variables</a>.</td>
</tr>
<tr>
<td><code>DB_SSL_CONNECTION</code></td>
<td>See <a href="../security%20and%20users/security.html#secure-environment-variables">Secure Environment variables</a>.</td>
</tr>
<tr>
<td><code>SOLR_ZOO_SSL_CONNECTION</code></td>
<td>See <a href="../security%20and%20users/security.html#secure-environment-variables">Secure Environment variables</a>.</td>
</tr>
<tr>
<td><code>SSL_PRIVATE_KEY</code></td>
<td>See <a href="../security%20and%20users/security.html#secure-environment-variables">Secure Environment variables</a>.</td>
</tr>
<tr>
<td><code>SSL_CERTIFICATE</code></td>
<td>See <a href="../security%20and%20users/security.html#secure-environment-variables">Secure Environment variables</a>.</td>
</tr>
<tr>
<td><code>SSL_CA_CERTIFICATE</code></td>
<td>See <a href="../security%20and%20users/security.html#secure-environment-variables">Secure Environment variables</a>.</td>
</tr>
<tr>
<td><code>GATEWAY_SSL_CONNECTION</code></td>
<td>See <a href="../security%20and%20users/security.html#secure-environment-variables">Secure Environment variables</a>.</td>
</tr>
<tr>
<td><code>SSL_OUTBOUND_PRIVATE_KEY</code></td>
<td>See <a href="../security%20and%20users/security.html#secure-environment-variables">Secure Environment variables</a>.</td>
</tr>
<tr>
<td><code>SSL_OUTBOUND_CERTIFICATE</code></td>
<td>See <a href="../security%20and%20users/security.html#secure-environment-variables">Secure Environment variables</a>.</td>
</tr>
</tbody>
</table>
<p><em>NOTE:</em></p>
<ul>
<li>when you set <code>SERVER_SSL</code> and <code>SSL_CA_CERTIFICATE</code> environment variables, the <code>CA.cer</code> certificate will be located at <code>/tmp/i2acerts/CA.cer</code>.</li>
<li>when you set <code>GATEWAY_SSL_CONNECTION</code>, <code>SSL_OUTBOUND_PRIVATE_KEY</code> and <code>SSL_OUTBOUND_CERTIFICATE</code> environment variables, the certificated will be located at <code>/tmp/i2acerts/i2Analyze.pem</code>.</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            &copy; N. Harris Computer Corporation (2022)
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
